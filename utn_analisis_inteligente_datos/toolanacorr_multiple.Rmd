---
title: "Analisis_Correspondencia"
author: "Área de Planificación Gestión y Estadística"
date: "21/3/2022"
output: html_document
params:
  nombre_dataset:
    label: "Seleccione nombre data set:"
    value: "ninguno"
    input: select
    choices: [practica1, nadadores,]
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = T, warning = F, message = F)
source("Unidad0_repos_and_tools.R")
# library('FactoMineR')
# bibliograf
# https://rpubs.com/lucia_cabrera/610195

```


```{r}
df <- readxl::read_xlsx("empresa.xlsx")

```

```{r}

Pegar p.212

```

## Analisis de Correspondencia Multiples: test Chi-Cuadrado


En base a matriz disyuntiva. Tantas columnas como niveles en medición en cada variable p.

La matriz de Burt resulta del producto de la matriz disyuntiva y su traspuesta. Ello determina que es un matriz simétrica definida y positiva. La tabla de Burt es una yuxtaposición de las tablas de contingencia y está formada pro bloques. Cada bloque es una submatriz formada por tablas de contiengencia correspondientes a las variables tomadas dos en dos.


SE APLICA TODO ACS!!!!!!!!!!!!!!!!!!!!!!!!!

```{r}

```

```{r}
# Para graficarlo con % fila (perifles fila)
df_prop = prop.table(as.matrix(df),margin=1) 
df_prop
```

```{r}
# Para graficarlo con % columna (perifles fila)
df_prop = prop.table(as.matrix(df),margin=2) 
df_prop
```

```{r}
library(gplots)
```

```{r}
# 1. convert the data as a table
dt <- as.table(as.matrix(df))
# 2. Graph
balloonplot(t(dt), main ="Grafico", xlab ="", ylab="",
            label = FALSE, show.margins = FALSE)
```

```{r}
prueba <- chisq.test(df)

```

```{r}
prueba
```
```{r}
qchisq(0.95,6) # se obtienen el estadístico de contraste completando el nivel de no rechazo (1-alfa) y los grados de libertd
```

Es posible observar que el estadístico de prueba chi cuadrado cuyo valor es de 40.049 resulta ser mayor al estadístico de contraste (12.6) y, en este orden de ideas, existe suficiente evidencia estadística para rechazar la hipótesis nula y aceptar la alterna que indica presencia de asociaciones.


```{r}
# Observed counts
prueba$observed
```
```{r}
# Expected counts
round(prueba$expected,2)
```
```{r}
# Cells with the highest absolute standardized residuals contribute the most to the total Chi-square score.

round(prueba$residuals, 3)
```

```{r}
library(corrplot)
corrplot(prueba$residuals, is.cor = FALSE)
```

```{r}
# Contibution in percentage (%)
contrib <- 100*prueba$residuals^2/prueba$statistic
round(contrib, 3)
```

```{r}
# Visualize the contribution
corrplot(contrib, is.cor = FALSE)
```

```{r}
# printing the p-value
prueba$p.value
```
```{r}
prueba$stdres
```

```{r}

ACS <- CA(datos_billete_cien, graph = FALSE)

```

