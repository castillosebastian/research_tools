coord_flip()
df %>%
ggplot(aes(x = organo, y = causas_iniciadas, color = circunscripcion)) +
geom_boxplot() +
geom_point() +
theme_bw() +
coord_flip()
df <- read_csv("causas_iniciadas_camara.csv") %>%
mutate(organo = str_c(circunscripcion, "-", organismo),
causas_iniciadas = ingresa) %>%
dplyr::select(organo, circunscripcion, fecha, causas_iniciadas)
df %>%
ggplot(aes(x = organo, y = causas_iniciadas, color = circunscripcion)) +
geom_boxplot() +
geom_point() +
theme_bw() +
coord_flip()
df %>%
ggplot(aes(x = organo, y = causas_iniciadas, color = circunscripcion)) +
geom_boxplot() +
theme_bw() +
coord_flip()
library(car)
knitr::opts_chunk$set(echo = T, warning = F, message = F)
source("Unidad0_repos_and_tools.R")
# library('FactoMineR')
# bibliograf
# https://rpubs.com/Miguel_Tripp/anova
# https://www.cienciadedatos.net/documentos/19_anova.html
# https://www.cienciadedatos.net/documentos/9_homogeneidad_de_varianza_homocedasticidad.html
leveneTest(y = causas_iniciadas_camara, group = organo, center = 'median')
leveneTest(y = causas_iniciadas, group = organo, center = 'median')
df %>%
leveneTest(y = causas_iniciadas, group = organo, center = 'median')
leveneTest(y = df$causas_iniciadas, group = df$organo, center = 'median')
bartlett.test(df)
bartlett.test(df$causas_iniciadas ~ df$organo)
options(scipen = 999)
bartlett.test(df$causas_iniciadas ~ df$organo)
leveneTest(y = df$causas_iniciadas, group = df$organo, center = 'median')
df %>%
ggplot(aes(x=organo, fill=causas_iniciadas)) +
geom_density(alpha=.25)
df %>%
ggplot(aes(x=organo, fill=causas_iniciadas)) +
geom_density()
df %>%
ggplot(aes(x=causas_iniciadas, color=organo)) +
geom_density()
df %>%
ggplot(aes(x=causas_iniciadas, color=organo)) +
geom_density() %>%
facet_grid(organo)
df %>%
ggplot(aes(x=causas_iniciadas, color=organo)) +
geom_density() %>%
facet_wrap(.~ organo)
df %>%
ggplot(aes(x=causas_iniciadas, color=organo)) +
geom_density() %>%
facet_grid(organo)
df %>%
ggplot(aes(x=causas_iniciadas, color=organo)) +
geom_density()
df %>%
ggplot(aes(x=causas_iniciadas, color=organo)) +
geom_density() +
facet_grid(organo ~ .)
df %>%
ggplot(aes(x=causas_iniciadas, color=organo)) +
geom_density() +
facet_wrap(organo ~ .)
df %>%
ggplot(aes(x=causas_iniciadas, color=organo)) +
geom_density() +
facet_wrap(organo ~ .) %>%
theme(legend.position = 'none')
df %>%
ggplot(aes(x=causas_iniciadas, color=organo)) +
geom_density() +
facet_wrap(organo ~ .) +
theme(legend.position = 'none')
df %>%
ggplot(aes(x=causas_iniciadas, color=circunscripcion)) +
geom_density() +
facet_wrap(organo ~ .) +
theme(legend.position = 'none')
df %>%
ggplot(aes(x=causas_iniciadas, color=circunscripcion)) +
geom_density() +
facet_wrap(organo ~ .) # +
#theme(legend.position = 'none')
df %>%
ggplot(aes(sample = causas_iniciadas, colour = circunscripcion))+
stat_qq(show.legend = F)+
stat_qq_line()+
facet_wrap(.~ organo)
knitr::opts_chunk$set(echo = T, warning = F, message = F)
source("Unidad0_repos_and_tools.R")
# library('FactoMineR')
# bibliograf
# https://rpubs.com/Miguel_Tripp/anova
# https://www.cienciadedatos.net/documentos/19_anova.html
# https://www.cienciadedatos.net/documentos/9_homogeneidad_de_varianza_homocedasticidad.html
#https://fhernanb.github.io/Manual-de-R/ph.html#prueba-de-hip%C3%B3tesis-para-la-varianza-sigma2-de-una-poblaci%C3%B3n-normal
bartlett.test(df$causas_iniciadas ~ df$organo)
leveneTest(y = df$causas_iniciadas, group = df$organo, center = 'median')
knitr::opts_chunk$set(echo = T, warning = F, message = F)
source("Unidad0_repos_and_tools.R")
# library('FactoMineR')
# bibliograf
# https://rpubs.com/Miguel_Tripp/anova ACA
# https://www.cienciadedatos.net/documentos/19_anova.html
# https://www.cienciadedatos.net/documentos/9_homogeneidad_de_varianza_homocedasticidad.html
#https://fhernanb.github.io/Manual-de-R/ph.html#prueba-de-hip%C3%B3tesis-para-la-varianza-sigma2-de-una-poblaci%C3%B3n-normal
bartlett.test(df$causas_iniciadas ~ df$organo)
leveneTest(y = df$causas_iniciadas, group = df$organo, center = 'median')
options(scipen = 999)
leveneTest(y = df$causas_iniciadas, group = df$organo, center = 'median')
bartlett.test(df$causas_iniciadas ~ df$organo)
df_anova = aov(data = df, causas_iniciadas ~ organo )
summary(df_anova)
shapiro.test(df_anova)
df <- read_csv("causas_iniciadas_camara.csv") %>%
mutate(organo = str_c(circunscripcion, "-", organismo),
causas_iniciadas = ingresa) %>%
dplyr::select(organo, circunscripcion, fecha, causas_iniciadas)
str(df)
df_anova = aov(data = df, causas_iniciadas ~ organo )
summary(df_anova)
shapiro.test(residuals(df_anova))
ad.test(residuals(df_anova))
install.packages("nortest")
source('~/R/research_tools/utn_analisis_inteligente_datos/Unidad0_repos_and_tools.R')
ad.test(residuals(df_anova))
agostino.test(residuals(df_anova))
df %>%
ggplot(aes(x=causas_iniciadas, color=circunscripcion)) +
geom_density() +
facet_wrap(organo ~ .) # +
#theme(legend.position = 'none')
df %>%
ggplot(aes(sample = causas_iniciadas, colour = circunscripcion))+
stat_qq(show.legend = F)+
stat_qq_line()+
facet_wrap(.~ organo)
knitr::opts_chunk$set(echo = T, warning = F, message = F)
source("Unidad0_repos_and_tools.R")
# library('FactoMineR')
# bibliograf
# https://rpubs.com/Miguel_Tripp/anova ACA
# https://www.cienciadedatos.net/documentos/19_anova.html
# https://www.cienciadedatos.net/documentos/9_homogeneidad_de_varianza_homocedasticidad.html
#https://fhernanb.github.io/Manual-de-R/ph.html#prueba-de-hip%C3%B3tesis-para-la-varianza-sigma2-de-una-poblaci%C3%B3n-normal
df %>%
ggplot(aes(sample = causas_iniciadas, colour = circunscripcion))+
stat_qq(show.legend = F)+
stat_qq_line()+
facet_wrap(.~ organo)
boxcox(lm(df$causas_iniciadas ~ df$organo))
boxcox(lm(df$causas_iniciadas))
str(df)
boxcox(df$causas_iniciadas, df$organo)
df$causas_iniciadas
df$organo
boxcox(df$causas_iniciadas~df$organo)
df$causas_iniciadas
arrange(df$causas_iniciadas)
boxcox(df$causas_iniciadas~df$organo)
boxcox(as.integer(df$causas_iniciadas)~df$organo)
boxcox(df$causas_iniciadas~df$organo)
df$causas_iniciadas
df$causas_iniciadas > 0
df <- df %>% filter(causas_iniciadas > 0)
boxcox(df$causas_iniciadas~df$organo)
df <- df %>% filter(causas_iniciadas > 0)
b = boxcox(df$causas_iniciadas~df$organo)
b
# Lambda exacto
lambda <- b$x[which.max(b$y)]
# Lambda exacto
lambda <- b$x[which.max(b$y)]
df$causas_iniciadas <- (df$causas_iniciadas ^ lambda - 1) / lambda
fit2=lm(df$causas_iniciadas^lamda~df$organo)
fit2=lm(df$causas_iniciadas^lambda~df$organo)
summary(fit2)
qqPlot(fit2$residuals, col.lines = "green")
str(fit2)
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolANOVA.Rmd')
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolANOVA.Rmd')
library(readxl)
dataset <- read_excel(NULL)
View(dataset)
library(readxl)
te <- read_excel("utn_analisis_inteligente_datos/te.xls")
View(te)
te %>% filter(Marca ==1)
te %>% t()
library(readxl)
te <- read_excel("utn_analisis_inteligente_datos/te.xls")
View(te)
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolANOVA (1) (2).Rmd')
setwd("~/R/research_tools/utn_analisis_inteligente_datos")
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolANOVA.Rmd')
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolANOVA.Rmd')
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolANOVA.Rmd')
knitr::opts_chunk$set(echo = F, warning = F, message = F)
#source("Unidad0_repos_and_tools.R")
library(readr)
library(dplyr)
library(ggplot2)
library(nortest)
library(moments)
# library('FactoMineR')
# bibliograf
# https://bookdown.org/steve_midway/DAR/understanding-anova-in-r.html _______IMPORTANTE_________
# https://rpubs.com/Miguel_Tripp/anova
# https://www.cienciadedatos.net/documentos/19_anova.html
# https://www.cienciadedatos.net/documentos/9_homogeneidad_de_varianza_homocedasticidad.html
#https://fhernanb.github.io/Manual-de-R/ph.html#prueba-de-hip%C3%B3tesis-para-la-varianza-sigma2-de-una-poblaci%C3%B3n-normal
ltest = car::leveneTest(y = df[[{{variable_numerica}}]], group = df[[{{variable_factor}}]], center = 'median')
library(readr)
dataset <- read_csv(NULL)
View(dataset)
library(readr)
te <- read_csv("te.csv")
View(te)
df = T
df = te
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolANOVA.Rmd')
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolANOVA.Rmd')
ltest = car::leveneTest(te$VitaminaB, group = te$Marca, center = 'median')
ltest
ltest$`Pr(>F)`
ltest$`Pr(>F)`[1]
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolANOVA.Rmd')
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolANOVA.Rmd')
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolANOVA.Rmd')
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolANOVA.Rmd')
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolANOVA.Rmd')
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolANOVA.Rmd')
library(readr)
conejos <- read_csv("conejos.csv")
View(conejos)
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolANOVA.Rmd')
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolANOVA.Rmd')
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolANOVA.Rmd')
if(ctranformacion){
bm = MASS::boxcox(lm(values~fact))
lambda= bm$x
lik= bm$y
bcm=cbind(lambda,lik)
bcm[order(lik),]
lamvalue=bm$x[which(bm$y==max(bm$y))]
values = values^lamvalue
df_anova =  aov(values ~ fact, data = df )
} else{
df_anova =  aov(values ~ fact, data = df )
}
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolANOVA.Rmd')
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolANOVA.Rmd')
install.packages("pgirmess")
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolANOVA.Rmd')
library(readr)
dataset <- read_csv(NULL)
View(dataset)
library(readr)
avispas <- read_delim("utn_analisis_inteligente_datos/avispas.csv",
delim = ";", escape_double = FALSE, trim_ws = TRUE)
View(avispas)
knitr::opts_chunk$set(echo = F, warning = F, message = F)
source("Unidad0_repos_and_tools.R")
# library('FactoMineR')
# bibliograf
# https://bookdown.org/steve_midway/DAR/understanding-anova-in-r.html _______IMPORTANTE_________
# https://rpubs.com/Miguel_Tripp/anova
# https://www.cienciadedatos.net/documentos/19_anova.html
# https://www.cienciadedatos.net/documentos/9_homogeneidad_de_varianza_homocedasticidad.html
#https://fhernanb.github.io/Manual-de-R/ph.html#prueba-de-hip%C3%B3tesis-para-la-varianza-sigma2-de-una-poblaci%C3%B3n-normal
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolANOVA.Rmd')
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolANOVA.Rmd')
library(readr)
avispas <- read_delim("utn_analisis_inteligente_datos/avispas.csv",
delim = ";", escape_double = FALSE, trim_ws = TRUE)
View(avispas)
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolANOVA.Rmd')
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolANOVA.Rmd')
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolANOVA.Rmd')
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolANOVA.Rmd')
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolANOVA.Rmd')
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolsegundoparcial.Rmd')
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolsegundoparcial.Rmd')
str(df) %>% kable()
summary(df_anova) %>% kable()
summary(df_anova) %>% formattable::formattable()
summary(df_anova) %>% formattable::format_table()
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolsegundoparcial.Rmd')
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolsegundoparcial.Rmd')
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolsegundoparcial.Rmd')
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolsegundoparcial.Rmd')
install.packages("gt")
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolsegundoparcial.Rmd')
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolsegundoparcial.Rmd')
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolsegundoparcial.Rmd')
str(df) %>% as_tibble()
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolsegundoparcial.Rmd')
input <- ("
especie pata abdomen organo_sexual
a 191 131 53
a 185 134 50
a 200 137 52
a 173 127 50
a 171 128 49
a 160 118 47
a 188 134 54
a 186 129 51
a 174 131 52
a 163 115 47
b 186 107 49
b 211 122 49
b 201 144 47
b 242 131 54
b 184 108 43
b 211 118 51
b 217 122 49
b 223 127 51
b 208 125 50
b 199 124 46
")
datos <- read.table(textConnection(input), header = TRUE)
datos$especie <- as.factor(datos$especie)
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolsegundoparcial.Rmd')
input <- ("
especie pata abdomen organo_sexual
a 191 131 53
a 185 134 50
a 200 137 52
a 173 127 50
a 171 128 49
a 160 118 47
a 188 134 54
a 186 129 51
a 174 131 52
a 163 115 47
b 186 107 49
b 211 122 49
b 201 144 47
b 242 131 54
b 184 108 43
b 211 118 51
b 217 122 49
b 223 127 51
b 208 125 50
b 199 124 46
")
datos <- read.table(textConnection(input), header = TRUE)
# factorizo variable factor
datos[[{{variable_factor}}]] = as.factor(datos[[{{variable_factor}}]])
variable_factor = "especie"
input <- ("
especie pata abdomen organo_sexual
a 191 131 53
a 185 134 50
a 200 137 52
a 173 127 50
a 171 128 49
a 160 118 47
a 188 134 54
a 186 129 51
a 174 131 52
a 163 115 47
b 186 107 49
b 211 122 49
b 201 144 47
b 242 131 54
b 184 108 43
b 211 118 51
b 217 122 49
b 223 127 51
b 208 125 50
b 199 124 46
")
datos <- read.table(textConnection(input), header = TRUE)
# factorizo variable factor
datos[[{{variable_factor}}]] = as.factor(datos[[{{variable_factor}}]])
pairs(x = datos[, c("pata","abdomen","organo_sexual")],
col = c("firebrick", "green3")[datos[[{{variable_factor}}]]], pch = 19)
colnames(datos)[[{{variable_factor}}]]
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolsegundoparcial.Rmd')
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolsegundoparcial.Rmd')
input <- ("
especie pata abdomen organo_sexual
a 191 131 53
a 185 134 50
a 200 137 52
a 173 127 50
a 171 128 49
a 160 118 47
a 188 134 54
a 186 129 51
a 174 131 52
a 163 115 47
b 186 107 49
b 211 122 49
b 201 144 47
b 242 131 54
b 184 108 43
b 211 118 51
b 217 122 49
b 223 127 51
b 208 125 50
b 199 124 46
")
datos <- read.table(textConnection(input), header = TRUE)
# factorizo variable factor
datos[[{{variable_factor}}]] = as.factor(datos[[{{variable_factor}}]])
pairs(x = datos[, c("pata","abdomen","organo_sexual")],
col = c("firebrick", "green3")[datos[[{{variable_factor}}]]], pch = 19)
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolsegundoparcial.Rmd')
knit_with_parameters('~/R/research_tools/utn_analisis_inteligente_datos/toolsegundoparcial.Rmd')
# Representación mediante Histograma de cada variable para cada especie
#par(mfcol = c(2, 3))
for (k in 2:4) {
j0 <- names(datos)[k]
#br0 <- seq(min(datos[, k]), max(datos[, k]), le = 11)
x0 <- seq(min(datos[, k]), max(datos[, k]), le = 50)
for (i in 1:2) {
i0 <- levels(datos[[{{variable_factor_lda}}]])[i]
x <- datos[datos[[{{variable_factor_lda}}]] == i0, j0]
hist(x, proba = T, col = grey(0.8), main = paste(variable_factor_lda, i0), xlab = j0)
lines(x0, dnorm(x0, mean(x), sd(x)), col = "red", lwd = 2)
}
}
variable_factor_lda = "especie"
# Representación mediante Histograma de cada variable para cada especie
#par(mfcol = c(2, 3))
for (k in 2:4) {
j0 <- names(datos)[k]
#br0 <- seq(min(datos[, k]), max(datos[, k]), le = 11)
x0 <- seq(min(datos[, k]), max(datos[, k]), le = 50)
for (i in 1:2) {
i0 <- levels(datos[[{{variable_factor_lda}}]])[i]
x <- datos[datos[[{{variable_factor_lda}}]] == i0, j0]
hist(x, proba = T, col = grey(0.8), main = paste(variable_factor_lda, i0), xlab = j0)
lines(x0, dnorm(x0, mean(x), sd(x)), col = "red", lwd = 2)
}
}
# Representación mediante Histograma de cada variable para cada especie
par(mfcol = 3)
# Representación mediante Histograma de cada variable para cada especie
par(mfcol = c(2, 3))
for (k in 2:4) {
j0 <- names(datos)[k]
#br0 <- seq(min(datos[, k]), max(datos[, k]), le = 11)
x0 <- seq(min(datos[, k]), max(datos[, k]), le = 50)
for (i in 1:2) {
i0 <- levels(datos[[{{variable_factor_lda}}]])[i]
x <- datos[datos[[{{variable_factor_lda}}]] == i0, j0]
hist(x, proba = T, col = grey(0.8), main = paste(variable_factor_lda, i0), xlab = j0)
lines(x0, dnorm(x0, mean(x), sd(x)), col = "red", lwd = 2)
}
}
dim(datos)
dim(datos)[2]
dim(datos)[2]-1
# Representación mediante Histograma de cada variable para cada especie
par(mfcol = c(unique(datos[[{{variable_factor_lda}}]]), dim(datos)[2]-1))
unique(datos[[{{variable_factor_lda}}]])
length(datos[[{{variable_factor_lda}}]])
lengths(datos[[{{variable_factor_lda}}]])
length(unique(datos[[{{variable_factor_lda}}]]))
# Representación mediante Histograma de cada variable para cada especie
par(mfcol = c(length(unique(datos[[{{variable_factor_lda}}]])), dim(datos)[2]-1))
for (k in 2:4) {
j0 <- names(datos)[k]
#br0 <- seq(min(datos[, k]), max(datos[, k]), le = 11)
x0 <- seq(min(datos[, k]), max(datos[, k]), le = 50)
for (i in 1:2) {
i0 <- levels(datos[[{{variable_factor_lda}}]])[i]
x <- datos[datos[[{{variable_factor_lda}}]] == i0, j0]
hist(x, proba = T, col = grey(0.8), main = paste(variable_factor_lda, i0), xlab = j0)
lines(x0, dnorm(x0, mean(x), sd(x)), col = "red", lwd = 2)
}
}
datos_tidy <- melt(datos, value.name = "valor")
library(reshape2)
datos_tidy <- melt(datos, value.name = "valor")
datos_tidy
library(reshape2)
datos_tidy <- melt(datos, value.name = "valor")
kable(datos_tidy %>% group_by(variable_factor_lda, variable) %>% summarise(p_value_Shapiro.test = shapiro.test(valor)$p.value))
library(reshape2)
datos_tidy <- melt(datos, value.name = "valor")
kable(datos_tidy %>% group_by({{variable_factor_lda}}, variable) %>% summarise(p_value_Shapiro.test = shapiro.test(valor)$p.value))
l <- length(unique(datos[[{{variable_factor_lda}}]]))
l
l <- length(unique(datos[[{{variable_factor_lda}}]]))
pairs(x = datos[, c("pata","abdomen","organo_sexual")],
col = hcl.colors(l, "Temps")[datos[[{{variable_factor_lda}}]]], pch = 19)
# Representación mediante Histograma de cada variable para cada especie
par(mfcol = c(l, dim(datos)[2]-1))
for (k in 2:4) {
j0 <- names(datos)[k]
#br0 <- seq(min(datos[, k]), max(datos[, k]), le = 11)
x0 <- seq(min(datos[, k]), max(datos[, k]), le = 50)
for (i in 1:2) {
i0 <- levels(datos[[{{variable_factor_lda}}]])[i]
x <- datos[datos[[{{variable_factor_lda}}]] == i0, j0]
hist(x, proba = T, col = grey(0.8), main = paste(variable_factor_lda, i0), xlab = j0)
lines(x0, dnorm(x0, mean(x), sd(x)), col = "red", lwd = 2)
}
}
